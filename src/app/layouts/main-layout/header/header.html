<header
  class="transition-all duration-300 z-50"
  [ngClass]="{
    'fixed top-0 w-full': scrollDown(),
    '-top-20 md:-top-24': !scrollDown()
  }"
>
  <div class="backdrop-blur-lg bg-white/80 dark:bg-slate-950/80" [ngClass]="scrollDown() ? 'shadow-sm' : 'shadow-xs'">
    <nav class="top-navbar w-full lg:max-w-5xl xl:max-w-7xl mx-auto flex justify-between items-center h-16 lg:h-20 gap-2 px-4 sm:px-6 py-4">
      <a routerLink="/" class="text-nowrap font-bold">Hasanov Academy</a>

      @if (currentView() === view.Desktop) {
      <p-menubar
        class="!bg-transparent"
        [model]="primaryNavs()"
        [breakpoint]="'820px'"
        [style]="{ textTransform: 'capitalize', fontSize: '14px', border: 'none' }"
        aria-label="Asosiy navigatsiya"
      />
      }

      <div class="flex items-center gap-2">
        @if (isStudent()) {
          <p-button
            size="small"
            variant="text"
            routerLink="favourites"
            text
            icon="pi pi-heart"
            severity="secondary"
            class="flex items-center justify-center relative"
            aria-label="Tungi mavzu"
          >
            @if (favourites()) {
            <p-badge [value]="favourites()" severity="danger" class="absolute top-0.5 -right-0.5 scale-75" badgeSize="small" />
            }
          </p-button>
          <p-button
            size="small"
            variant="text"
            routerLink="cart"
            text
            icon="pi pi-shopping-cart"
            severity="secondary"
            class="flex items-center justify-center relative"
            aria-label="Tungi mavzu"
          >
            @if (cart()) {
            <p-badge [value]="cart()" severity="danger" class="absolute top-0.5 -right-0.5 scale-75" badgeSize="small" />
            }
          </p-button>
        }
        
        <p-button
          size="small"
          variant="text"
          severity="secondary"
          class="flex items-center justify-center"
          (onClick)="theme.toggleTheme()"
          [icon]="theme.themeIcon()"
          [ariaLabel]="theme.themeLabel()"
        />
        @if (currentView() === view.Desktop) {
          @if (profileNav()) {
          <p-speeddial
            ngClass="profile-navs"
            [model]="secondaryNavs()"
            direction="down"
            [transitionDelay]="80"
          >
            <ng-template #button let-toggleCallback="toggleCallback">
              <p-avatar
                [style]="{ color: 'white', backgroundColor: 'var(--p-orange-500)' }"
                (click)="toggleCallback($event)"
                shape="circle"
                [image]="avatar()"
                class="cursor-pointer hover:opacity-85 active:opacity-100"
              >
                @if (!avatar()?.length) {
                  <span>{{userName()?.slice(0, 1)}}</span>
                }
              </p-avatar>
            </ng-template>
            <ng-template #item let-item let-toggleCallback="toggleCallback">
              <a
                [routerLink]="item.routerLink"
                class="flex items-center hover:bg-[var(--p-menubar-item-active-background)] rounded transition-colors duration-200 gap-2 py-1.5 px-3 cursor-pointer text-sm"
                (click)="toggleCallback($event, item)"
                [ngClass]="item.styleClass"
              >
                <span [class]="item.icon"></span>
                <span>{{ item.label }}</span>
              </a>
            </ng-template>
          </p-speeddial>
          } @else {
          <p-button
            severity="warn"
            variant="text"
            routerLink="/auth/sign-in"
            [style]="{ textTransform: 'capitalize', fontSize: '14px', border: 'none' }"
            aria-label="Tizimga kirish"
          >
            <i class="pi pi-sign-in" aria-hidden="true"></i>
            <span class="leading-4">Kirish</span>
          </p-button>
          }
        }
      </div>
    </nav>
  </div>
</header>
